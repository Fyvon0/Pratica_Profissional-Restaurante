package daos;

import java.sql.*;
import banco.de.dados.*;
import Core.*;
import dbos.*;

public class Mesas {
	public boolean cadastrado (int codigo) throws Exception
	{
	    boolean retorno = false;
	
	    try
	    {
	        String sql;
	
	        sql = "SELECT * FROM Mesa WHERE codMesas=?";
	
	        DAOs.getBD().prepareStatement (sql);
	
	        DAOs.getBD().setInt (1, codigo);
	
	        MeuResultSet resultado = (MeuResultSet)DAOs.getBD().executeQuery ();
	
	        retorno = resultado.first();
	    }
	    catch (SQLException erro)
	    {
	        throw new Exception ("Erro ao procurar mesa");
	    }
	
	    return retorno;
	}
	
	public void incluir (Mesa mesa) throws Exception
    {
        if (mesa==null)
            throw new Exception ("Mesa nao fornecida");

        try
        {
            String sql = "INSERT INTO Mesa VALUES (?,?,?,?,?,?,?,?,?)";

            DAOs.getBD().prepareStatement (sql);

            DAOs.getBD().setInt(1, mesa.getCodMesa ());
            DAOs.getBD().setInt(2, mesa.getReserva ());
            DAOs.getBD().setTimestamp(3, mesa.getHorario ());
            DAOs.getBD().setTimestamp(4,mesa.getHoraPrevista());
            DAOs.getBD().setString(5,mesa.getFormaPagamento());
            DAOs.getBD().setBigDecimal(6, mesa.getValorTotal());
            DAOs.getBD().setTimestamp(7, mesa.getHoraFechamento());;
            DAOs.getBD().setInt(8, mesa.getStatusMesa());
            DAOs.getBD().setInt(9, mesa.getCodCliente());

            DAOs.getBD().executeUpdate ();
        }
        catch (SQLException erro)
        {
            throw new Exception ("Erro ao inserir livro");
        }
    }
}
